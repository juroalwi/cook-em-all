{"ast":null,"code":"import { GET_RECIPES, GET_DIETS, CHANGE_FILTERS, FILTER_RECIPES, SORT_RECIPES, SET_PAGE, SET_LOADING, SET_NOT_FOUND } from './actions.js';\nconst initialState = {\n  diets: [],\n  recipes: {\n    fetched: [],\n    displayed: []\n  },\n  parameters: {\n    displaying: false,\n    page: 0,\n    filters: []\n  },\n  notFound: false,\n  loading: false\n};\nexport default function reducer() {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let {\n    type,\n    payload\n  } = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (type) {\n    case GET_DIETS:\n      // Map diets from an array of objects to an array of strings\n      payload = payload.map(diet => diet.name);\n      return { ...state,\n        diets: payload\n      };\n\n    case GET_RECIPES:\n      // Map diets property of db recipes from an array of objects to an array of strings\n      payload[0] = payload[0].map(dbRecipe => ({ ...dbRecipe,\n        diets: dbRecipe.diets.map(diet => diet.name)\n      }));\n      return { ...state,\n        recipes: {\n          fetched: [...payload[0], ...payload[1]],\n          displayed: [...payload[0], ...payload[1]]\n        },\n        parameters: {\n          displaying: true,\n          page: 0,\n          filters: []\n        },\n        notFound: false,\n        loading: false\n      };\n\n    case CHANGE_FILTERS:\n      return { ...state,\n        parameters: { ...state.parameters,\n          filters: changeFilters([...state.parameters.filters], payload)\n        }\n      };\n\n    case FILTER_RECIPES:\n      return { ...state,\n        recipes: { ...state.recipes,\n          displayed: filterRecipes([...state.recipes.fetched], [...state.parameters.filters])\n        },\n        parameters: { ...state.parameters,\n          page: 0\n        }\n      };\n\n    case SORT_RECIPES:\n      return { ...state,\n        recipes: { ...state.recipes,\n          displayed: sortRecipes([...state.recipes.displayed], payload)\n        },\n        parameters: { ...state.parameters,\n          page: 0\n        }\n      };\n\n    case SET_PAGE:\n      return { ...state,\n        parameters: { ...state.parameters,\n          page: payload\n        }\n      };\n\n    case SET_LOADING:\n      return { ...state,\n        loading: payload\n      };\n\n    case SET_NOT_FOUND:\n      return { ...state,\n        notFound: payload\n      };\n\n    default:\n      return { ...state\n      };\n  }\n}\n;\n\nfunction changeFilters(filters, filter) {\n  filters.includes(filter) ? filters.splice(filters.indexOf(filter), 1) : filters.push(filter);\n  return filters;\n}\n\nfunction filterRecipes(recipes, filters) {\n  return recipes.filter(recipe => {\n    return filters.every(filter => recipe.diets.includes(filter));\n  });\n}\n\n;\n\nfunction sortRecipes(recipes, sortCriteria) {\n  switch (sortCriteria) {\n    case 'az':\n      return recipes.sort((x, y) => x.title.localeCompare(y.title));\n\n    case 'za':\n      return recipes.sort((x, y) => y.title.localeCompare(x.title));\n\n    case 'score':\n      return recipes.sort((x, y) => y.score - x.score);\n\n    default:\n      return recipes;\n  }\n}\n\n;","map":{"version":3,"sources":["/home/jralvarezwindey/Escritorio/henry-ip-food/client/src/redux/reducer.js"],"names":["GET_RECIPES","GET_DIETS","CHANGE_FILTERS","FILTER_RECIPES","SORT_RECIPES","SET_PAGE","SET_LOADING","SET_NOT_FOUND","initialState","diets","recipes","fetched","displayed","parameters","displaying","page","filters","notFound","loading","reducer","state","type","payload","map","diet","name","dbRecipe","changeFilters","filterRecipes","sortRecipes","filter","includes","splice","indexOf","push","recipe","every","sortCriteria","sort","x","y","title","localeCompare","score"],"mappings":"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","sourcesContent":["import { GET_RECIPES, GET_DIETS, CHANGE_FILTERS, FILTER_RECIPES, SORT_RECIPES, SET_PAGE, SET_LOADING, SET_NOT_FOUND } from './actions.js';\n\nconst initialState = {\n  diets: [],\n\n  recipes: {\n    fetched: [],\n    displayed: [],\n  },\n\n  parameters: {\n    displaying: false,\n    page: 0,\n    filters: [],\n  },\n\n  notFound: false,\n\n  loading: false,\n};\n\nexport default function reducer(state = initialState, { type, payload}) {\n  switch(type) {\n    case GET_DIETS:\n    // Map diets from an array of objects to an array of strings\n    payload = payload.map(diet => diet.name)\n      return {\n        ...state,\n        diets: payload,\n      }\n\n    case GET_RECIPES: \n    // Map diets property of db recipes from an array of objects to an array of strings\n      payload[0] = payload[0].map(dbRecipe => ({...dbRecipe, diets: dbRecipe.diets.map(diet => diet.name)}))\n      return {\n        ...state,\n        recipes: {\n          fetched: [...payload[0], ...payload[1]],\n          displayed: [...payload[0], ...payload[1]]\n        },\n        parameters: {\n          displaying: true,\n          page: 0, \n          filters: [],\n        },\n        notFound: false,\n        loading: false\n      };\n\n    case CHANGE_FILTERS: \n      return {\n        ...state,\n        parameters: {\n          ...state.parameters,\n          filters: changeFilters([...state.parameters.filters], payload)\n        }\n      }\n      \n    case FILTER_RECIPES:\n      return {\n        ...state,\n        recipes: {\n          ...state.recipes,\n          displayed: filterRecipes([...state.recipes.fetched], [...state.parameters.filters]) \n        },\n        parameters: {\n          ...state.parameters,\n          page: 0,\n        }\n      }\n\n    case SORT_RECIPES:\n      return {\n        ...state,\n        recipes: {\n          ...state.recipes,\n          displayed: sortRecipes([...state.recipes.displayed], payload),\n        },\n        parameters: {\n          ...state.parameters,\n          page: 0,\n        }\n      }\n\n    case SET_PAGE: \n      return {\n        ...state,\n        parameters: {\n          ...state.parameters,\n          page: payload \n        }\n      }\n\n    case SET_LOADING:\n      return {\n        ...state,\n        loading: payload\n      }\n\n    case SET_NOT_FOUND:\n      return {\n        ...state,\n        notFound: payload\n      }\n\n    default:\n      return {\n        ...state,\n      };\n  }\n};\n\nfunction changeFilters(filters, filter) {\n  filters.includes(filter) \n    ? filters.splice(filters.indexOf(filter), 1) \n    : filters.push(filter)\n  return filters;\n}\n\nfunction filterRecipes(recipes, filters) {\n  return recipes.filter(recipe => {\n    return filters.every(filter => recipe.diets.includes(filter))\n  })\n};\n\nfunction sortRecipes(recipes, sortCriteria) {\n  switch(sortCriteria) {\n    case 'az': return recipes.sort((x, y) => x.title.localeCompare(y.title));\n    case 'za': return recipes.sort((x, y) => y.title.localeCompare(x.title));\n    case 'score': return recipes.sort((x, y) => y.score - x.score);\n    default: return recipes;\n  }\n};\n\n"]},"metadata":{},"sourceType":"module"}